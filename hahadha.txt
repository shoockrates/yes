SELECT
  K.Pavadinimas,
  K.ISBN
FROM Stud.Knyga AS K
WHERE SUBSTRING(K.ISBN FROM 1 FOR 1) = SUBSTRING(K.ISBN FROM 4 FOR 1);

WITH last_month AS (
  SELECT
    date_trunc('month', current_date) - interval '1 month' AS start_dt,
    date_trunc('month', current_date) AS end_dt
)
SELECT COUNT(*) AS kiekis
FROM Stud.Egzempliorius e
CROSS JOIN last_month lm
WHERE e.Įsigyta >= lm.start_dt::date
  AND e.Įsigyta <  lm.end_dt::date
  AND EXISTS (
    SELECT 1
    FROM Stud.Skaitymas s
    WHERE s.Egzempliorius = e.Egzempliorius
  );
